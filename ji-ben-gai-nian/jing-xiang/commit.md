# Commit 命令

## 例子

定制一个Web 服务器

```text
$ docker run --name webserver -d -p 80:80 nginx
```

`docker commit` 可以在原有镜像的基础上，再叠加上容器的存储层，并构成新的镜像。

`docker commit` 的语法格式为：

```bash
docker commit [选项] <容器ID或容器名> [<仓库名>[:<标签>]]
```

修改文件后把容器保存为镜像：

```bash
$ docker commit \
    --author "Author name <email@gmail.com>" \
    --message "修改了默认网页" \
    webserver \
    nginx:v2
```

## 慎用 `docker commit`

### 臃肿

由于命令的执行，还有很多文件被改动或添加了。如果是安装软件包、编译构建，那会有大量的无关内容被添加进来，如果不小心清理，将会导致镜像极为臃肿。

因docker的镜像是分层存储，除了当前层外，之前的每一层都是不会发生改变的。换句话说，任何修改的结果仅仅是在当前层进行标记、添加、修改，而不会改动上一层。如果使用 `docker commit` 制作镜像，以及后期修改的话，每一次修改都会让镜像更加臃肿一次，_所删除的上一层的东西并不会丢失_，会一直如影随形的跟着这个镜像，即使根本无法访问到。这会让镜像更加臃肿。

### 不利于维护

使用 `docker commit` 意味着所有对镜像的操作都是黑箱操作，生成的镜像也被称为 **黑箱镜像。** 除了制作镜像的人知道执行过什么命令、怎么生成的镜像，别人根本无从得知。



